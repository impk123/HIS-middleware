<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hospital Middleware API System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .api-endpoint {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 8px;
        padding: 16px;
        margin: 8px 0;
        color: white;
      }
      .test-result {
        transition: all 0.3s ease;
      }
      .test-pass {
        background-color: #10b981;
      }
      .test-fail {
        background-color: #ef4444;
      }
      .er-diagram {
        background: linear-gradient(135deg, #424142 0%, #f5576c 100%);
        border-radius: 12px;
        padding: 20px;
        color: white;
      }
      .entity-box {
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 8px;
        padding: 12px;
        margin: 8px;
        backdrop-filter: blur(10px);
      }
      .relationship-line {
        border-top: 2px solid rgba(255, 255, 255, 0.6);
        position: relative;
        margin: 10px 0;
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">
          üè• Hospital Middleware API System
        </h1>
        <p class="text-gray-600">
          ‡∏£‡∏∞‡∏ö‡∏ö API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
        </p>
      </div>

      <!-- Navigation Tabs -->
      <div
        class="flex flex-wrap justify-center mb-6 bg-white rounded-lg shadow-lg p-2"
      >
        <button
          onclick="showTab('api')"
          class="tab-btn px-6 py-3 mx-1 rounded-lg font-medium transition-all duration-300 bg-blue-500 text-white"
        >
          API Endpoints
        </button>
        <button
          onclick="showTab('database')"
          class="tab-btn px-6 py-3 mx-1 rounded-lg font-medium transition-all duration-300 text-gray-600 hover:bg-gray-100"
        >
          Database Schema
        </button>
        <button
          onclick="showTab('testing')"
          class="tab-btn px-6 py-3 mx-1 rounded-lg font-medium transition-all duration-300 text-gray-600 hover:bg-gray-100"
        >
          Unit Tests
        </button>
        <button
          onclick="showTab('er-diagram')"
          class="tab-btn px-6 py-3 mx-1 rounded-lg font-medium transition-all duration-300 text-gray-600 hover:bg-gray-100"
        >
          ER Diagram
        </button>
      </div>

      <!-- API Endpoints Tab -->
      <div id="api" class="tab-content active">
        <div class="grid md:grid-cols-2 gap-6">
          <!-- Hospital A API Example -->
          <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">
              üè• Hospital A API (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
            </h3>
            <div class="api-endpoint">
              <div class="font-mono text-sm">GET /patient/search/{id}</div>
              <div class="text-sm mt-2 opacity-90">
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏î‡πâ‡∏ß‡∏¢ national_id ‡∏´‡∏£‡∏∑‡∏≠ passport_id
              </div>
            </div>
            <button
              onclick="testHospitalAPI()"
              class="mt-4 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API
            </button>
            <div
              id="hospital-result"
              class="mt-4 p-3 bg-gray-100 rounded-lg hidden"
            >
              <pre class="text-sm overflow-x-auto"></pre>
            </div>
          </div>

          <!-- Middleware APIs -->
          <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">
              üîó Middleware APIs
            </h3>

            <div class="api-endpoint">
              <div class="font-mono text-sm">POST /staff/create</div>
              <div class="text-sm mt-2 opacity-90">
                ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÉ‡∏´‡∏°‡πà
              </div>
            </div>

            <div class="api-endpoint">
              <div class="font-mono text-sm">POST /staff/login</div>
              <div class="text-sm mt-2 opacity-90">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
            </div>

            <div class="api-endpoint">
              <div class="font-mono text-sm">GET /patient/search</div>
              <div class="text-sm mt-2 opacity-90">
                ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô)
              </div>
            </div>
          </div>
        </div>

        <!-- API Testing Interface -->
        <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
          <h3 class="text-xl font-bold text-gray-800 mb-4">üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API</h3>

          <!-- Staff Creation -->
          <div class="mb-6 p-4 border border-gray-200 rounded-lg">
            <h4 class="font-semibold mb-3">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h4>
            <div class="grid md:grid-cols-2 gap-4">
              <input
                type="text"
                id="staff-name"
                placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
              <input
                type="email"
                id="staff-email"
                placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
              <input
                type="password"
                id="staff-password"
                placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
              <select
                id="staff-hospital"
                class="border border-gray-300 rounded-lg px-3 py-2"
              >
                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option>
                <option value="hospital-a">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• A</option>
                <option value="hospital-b">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• B</option>
                <option value="hospital-c">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• C</option>
              </select>
            </div>
            <button
              onclick="createStaff()"
              class="mt-3 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              ‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
            </button>
          </div>

          <!-- Staff Login -->
          <div class="mb-6 p-4 border border-gray-200 rounded-lg">
            <h4 class="font-semibold mb-3">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h4>
            <div class="grid md:grid-cols-2 gap-4">
              <input
                type="email"
                id="login-email"
                placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
              <input
                type="password"
                id="login-password"
                placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
            </div>
            <button
              onclick="loginStaff()"
              class="mt-3 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              üîê ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
            </button>
          </div>

          <!-- Patient Search -->
          <div class="mb-6 p-4 border border-gray-200 rounded-lg">
            <h4 class="font-semibold mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h4>
            <div class="grid md:grid-cols-3 gap-4">
              <input
                type="text"
                id="search-national-id"
                placeholder="‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
              <input
                type="text"
                id="search-passport"
                placeholder="‡πÄ‡∏•‡∏Ç Passport"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
              <input
                type="text"
                id="search-name"
                placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
            </div>
            <button
              onclick="searchPatient()"
              class="mt-3 bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
            </button>
          </div>

          <!-- Results Display -->
          <div id="api-results" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
            <h4 class="font-semibold mb-2">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</h4>
            <pre
              class="text-sm overflow-x-auto bg-white p-3 rounded border"
            ></pre>
          </div>
        </div>
      </div>

      <!-- Database Schema Tab -->
      <div id="database" class="tab-content">
        <div class="grid md:grid-cols-2 gap-6">
          <!-- Patient Model -->
          <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">
              üë§ Patient Model
            </h3>
            <div class="bg-gray-50 p-4 rounded-lg font-mono text-sm">
              <div class="text-blue-600 font-semibold mb-2">
                Patient Schema:
              </div>
              <div>‚Ä¢ ID uint `gorm:"primaryKey"`</div>
              <div>
                ‚Ä¢ FirstNameTh string `gorm:"size:100;not null"
                json:"first_name"`
              </div>
              <div>
                ‚Ä¢ MiddleNameTh string `gorm:"size:100" json:"middle_name"`
              </div>
              <div>
                ‚Ä¢ LastNameTh string `gorm:"size:100;not null" json:"last_name"`
              </div>
              <div>‚Ä¢ FirstNameEn string `gorm:"size:100"`</div>
              <div>‚Ä¢ MiddleNameEn string `gorm:"size:100"`</div>
              <div>‚Ä¢ LastNameEn string `gorm:"size:100"`</div>
              <div>
                ‚Ä¢ DateOfBirth string `gorm:"type:date" json:"date_of_birth"`
              </div>
              <div>‚Ä¢ PatientHN string `gorm:"size:20;uniqueIndex"`</div>
              <div>
                ‚Ä¢ NationalID string `gorm:"size:13;" json:"national_id"`
              </div>
              <div>
                ‚Ä¢ PassportID string `gorm:"size:20;" json:"passport_id"`
              </div>
              <div>
                ‚Ä¢ PhoneNumber string `gorm:"size:20" json:"phone_number"`
              </div>
              <div>‚Ä¢ Email string `gorm:"size:100" json:"email"`</div>
              <div>‚Ä¢ Gender string `gorm:"size:1"` // M or F</div>
              <div>‚Ä¢ Address string `gorm:"size:254"`</div>
              <div>‚Ä¢ Hospital string `gorm:"size:50;not null"`</div>
            </div>
          </div>

          <!-- Staff Model -->
          <div class="bg-white rounded-lg shadow-lg p-6">
            <h3 class="text-xl font-bold text-gray-800 mb-4">üë®‚Äç‚öïÔ∏è Staff Model</h3>
            <div class="bg-gray-50 p-4 rounded-lg font-mono text-sm">
              <div class="text-green-600 font-semibold mb-2">Staff Schema:</div>
              <div>‚Ä¢ FirstNameTH string `json:"first_name_th"`</div>
              <div>‚Ä¢ MiddleNameTH string `json:"middle_name_th"`</div>
              <div>‚Ä¢ LastNameTH string `json:"last_name_th"`</div>
              <div>‚Ä¢ FirstNameEN string `json:"first_name_en"`</div>
              <div>‚Ä¢ MiddleNameEN string `json:"middle_name_en"`</div>
              <div>‚Ä¢ LastNameEN string `json:"last_name_en"`</div>
              <div>‚Ä¢ DateOfBirth string `json:"date_of_birth"`</div>
              <div>‚Ä¢ PatientHN string `json:"patient_hn"`</div>
              <div>‚Ä¢ NationalID string `json:"national_id"`</div>
              <div>‚Ä¢ PassportID string `json:"passport_id"`</div>
              <div>‚Ä¢ PhoneNumber string `json:"phone_number"`</div>
              <div>‚Ä¢ Email string `json:"email"`</div>
              <div>‚Ä¢ Gender string `json:"gender"`</div>

              <div>‚Ä¢ Hospital string `json:"hospital"`</div>
            </div>
          </div>

          <!-- Hospital Model -->
          <div class="bg-white rounded-lg shadow-lg p-6 md:col-span-2">
            <h3 class="text-xl font-bold text-gray-800 mb-4">
              üè• Hospital Model
            </h3>
            <div class="bg-gray-50 p-4 rounded-lg font-mono text-sm">
              <div class="text-purple-600 font-semibold mb-2">
                Hospital Schema:
              </div>
              <div>‚Ä¢ id: UUID (Primary Key)</div>
              <div>‚Ä¢ name: String</div>
              <div>‚Ä¢ code: String (unique)</div>
              <div>‚Ä¢ api_endpoint: String</div>
              <div>‚Ä¢ api_key: String (encrypted)</div>
              <div>‚Ä¢ address: Text</div>
              <div>‚Ä¢ phone: String</div>
              <div>‚Ä¢ email: String</div>
              <div>‚Ä¢ is_active: Boolean</div>
              <div>‚Ä¢ created_at: Timestamp</div>
              <div>‚Ä¢ updated_at: Timestamp</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Unit Tests Tab -->
      <div id="testing" class="tab-content">
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h3 class="text-xl font-bold text-gray-800 mb-4">üß™ Unit Tests</h3>

          <div class="mb-6">
            <button
              onclick="runAllTests()"
              class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors"
            >
              ‚ñ∂Ô∏è ‡∏£‡∏±‡∏ô‡πÄ‡∏ó‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
          </div>

          <div class="space-y-4">
            <!-- Staff Creation Tests -->
            <div class="border border-gray-200 rounded-lg p-4">
              <h4 class="font-semibold mb-3">Staff Creation API Tests</h4>
              <div class="space-y-2">
                <div
                  id="test-staff-create-success"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should create staff successfully with valid data</span
                  >
                </div>
                <div
                  id="test-staff-create-duplicate"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should reject duplicate email</span
                  >
                </div>
                <div
                  id="test-staff-create-invalid"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should reject invalid hospital_id</span
                  >
                </div>
              </div>
            </div>

            <!-- Staff Login Tests -->
            <div class="border border-gray-200 rounded-lg p-4">
              <h4 class="font-semibold mb-3">Staff Login API Tests</h4>
              <div class="space-y-2">
                <div
                  id="test-login-success"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should login successfully with valid credentials</span
                  >
                </div>
                <div
                  id="test-login-invalid"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should reject invalid credentials</span
                  >
                </div>
                <div
                  id="test-login-inactive"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should reject inactive staff</span
                  >
                </div>
              </div>
            </div>

            <!-- Patient Search Tests -->
            <div class="border border-gray-200 rounded-lg p-4">
              <h4 class="font-semibold mb-3">Patient Search API Tests</h4>
              <div class="space-y-2">
                <div
                  id="test-search-authorized"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should return patients from same hospital</span
                  >
                </div>
                <div
                  id="test-search-unauthorized"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should reject unauthorized access</span
                  >
                </div>
                <div
                  id="test-search-cross-hospital"
                  class="test-result p-3 rounded-lg bg-gray-100"
                >
                  <span class="font-mono text-sm"
                    >‚úì Should not return patients from other hospitals</span
                  >
                </div>
              </div>
            </div>
          </div>

          <div id="test-summary" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
            <h4 class="font-semibold mb-2">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</h4>
            <div class="text-sm">
              <span id="test-passed" class="text-green-600 font-medium">0</span>
              ‡∏ú‡πà‡∏≤‡∏ô,
              <span id="test-failed" class="text-red-600 font-medium">0</span>
              ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô
            </div>
          </div>
        </div>
      </div>

      <!-- ER Diagram Tab -->
      <div id="er-diagram" class="tab-content">
        <div class="er-diagram">
          <h3 class="text-2xl font-bold text-center mb-6">
            üìä Entity Relationship Diagram
          </h3>

          <div class="grid md:grid-cols-3 gap-6 mb-8">
            <!-- Hospital Entity -->
            <div class="entity-box text-center">
              <h4 class="font-bold text-lg mb-3">üè• HOSPITAL</h4>
              <div class="text-sm space-y-1">
                <div>FirstNameTH</div>
                <div>MiddleNameTH</div>
                <div>LastNameTH</div>
                <div>FirstNameEN</div>
                <div>MiddleNameEN</div>
                <div>LastNameEN</div>
                <div>DateOfBirth</div>
                <div>PatientHN</div>
                <div class="text-yellow-200">üîó NationalID</div>
                <div>is_active</div>
                <div>PassportID</div>
                <div>PhoneNumber</div>
                <div>Email</div>
                <div>Gender</div>
                <div>Hospital</div>
              </div>
            </div>

            <!-- Staff Entity -->
            <div class="entity-box text-center">
              <h4 class="font-bold text-lg mb-3">üë®‚Äç‚öïÔ∏è STAFF</h4>
              <div class="text-sm space-y-1">
                <div class="font-semibold border-b border-white/30 pb-1">
                  üîë ID (PK)
                </div>
                <div>Username</div>
                <div>Password</div>
                <div class="text-yellow-200">üîó hospital (FK)</div>
                <div>FirstNameTh</div>
                <div>LastNameTh</div>
              </div>
            </div>

            <!-- Patient Entity -->
            <div class="entity-box text-center">
              <h4 class="font-bold text-lg mb-3">üë§ PATIENT</h4>
              <div class="text-sm space-y-1">
                <div class="font-semibold border-b border-white/30 pb-1">
                  üîë ID (PK)
                </div>
                <div>FirstNameTh</div>
                <div>MiddleNameTh</div>
                <div>LastNameTh</div>
                <div>PassportID</div>
                <div>FirstNameEN</div>
                <div>LastNameEN</div>
                <div>DateOfBirth</div>
                <div>Gender</div>
                <div>PhoneNumber</div>
                <div>Email</div>
                <div>Address</div>
                <div class="text-yellow-200">üîó hospital (FK)</div>
              </div>
            </div>
          </div>

          <!-- Relationships -->
          <div class="space-y-4">
            <div class="text-center">
              <div class="relationship-line"></div>
              <div class="text-sm font-medium">HOSPITAL (1) ‚Üê‚Üí (N) STAFF</div>
              <div class="text-xs opacity-80">
                ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÅ‡∏´‡πà‡∏á‡∏°‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô
              </div>
            </div>

            <div class="text-center">
              <div class="relationship-line"></div>
              <div class="text-sm font-medium">HOSPITAL (1) ‚Üê‚Üí (N) PATIENT</div>
              <div class="text-xs opacity-80">
                ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÅ‡∏´‡πà‡∏á‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô
              </div>
            </div>
          </div>

          <!-- Business Rules -->
          <div class="mt-8 p-4 bg-white/10 rounded-lg">
            <h4 class="font-bold mb-3">üìã Business Rules:</h4>
            <ul class="text-sm space-y-2">
              <li>
                ‚Ä¢
                ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
              </li>
              <li>‚Ä¢ ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</li>
              <li>‚Ä¢ ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô API ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</li>
              <li>
                ‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Passport
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Mock data
      let hospitals = [
        { id: "hosp-1", name: "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• A", code: "hospital-a" },
        { id: "hosp-2", name: "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• B", code: "hospital-b" },
        { id: "hosp-3", name: "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• C", code: "hospital-c" },
      ];

      let staff = [];
      let patients = [
        {
          id: "pat-1",
          national_id: "1234567890123",
          first_name: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
          last_name: "‡πÉ‡∏à‡∏î‡∏µ",
          hospital_id: "hosp-1",
        },
        {
          id: "pat-2",
          passport_id: "AB1234567",
          first_name: "John",
          last_name: "Smith",
          hospital_id: "hosp-1",
        },
        {
          id: "pat-3",
          national_id: "9876543210987",
          first_name: "‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á",
          last_name: "‡∏£‡∏±‡∏Å‡∏î‡∏µ",
          hospital_id: "hosp-2",
        },
      ];

      let currentUser = null;

      // Tab functionality
      function showTab(tabName) {
        // Hide all tabs
        document.querySelectorAll(".tab-content").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Remove active class from all buttons
        document.querySelectorAll(".tab-btn").forEach((btn) => {
          btn.classList.remove("bg-blue-500", "text-white");
          btn.classList.add("text-gray-600", "hover:bg-gray-100");
        });

        // Show selected tab
        document.getElementById(tabName).classList.add("active");

        // Activate selected button
        event.target.classList.remove("text-gray-600", "hover:bg-gray-100");
        event.target.classList.add("bg-blue-500", "text-white");
      }

      // API Functions
      function testHospitalAPI() {
        const mockResponse = {
          success: true,
          data: {
            id: "pat-001",
            national_id: "1234567890123",
            first_name: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
            last_name: "‡πÉ‡∏à‡∏î‡∏µ",
            date_of_birth: "1990-05-15",
            gender: "M",
            phone: "081-234-5678",
            email: "somchai@email.com",
          },
        };

        const resultDiv = document.getElementById("hospital-result");
        resultDiv.classList.remove("hidden");
        resultDiv.querySelector("pre").textContent = JSON.stringify(
          mockResponse,
          null,
          2
        );
      }

      function createStaff() {
        const name = document.getElementById("staff-name").value;
        const email = document.getElementById("staff-email").value;
        const password = document.getElementById("staff-password").value;
        const hospitalCode = document.getElementById("staff-hospital").value;

        if (!name || !email || !password || !hospitalCode) {
          showResult("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô", false);
          return;
        }

        // Check if email already exists
        if (staff.find((s) => s.email === email)) {
          showResult("‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß", false);
          return;
        }

        const hospital = hospitals.find((h) => h.code === hospitalCode);
        const newStaff = {
          id: "staff-" + Date.now(),
          name: name,
          email: email,
          password: password,
          hospital_id: hospital.id,
          hospital_name: hospital.name,
          created_at: new Date().toISOString(),
        };

        staff.push(newStaff);
        showResult(`‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ${name} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, true);

        // Clear form
        document.getElementById("staff-name").value = "";
        document.getElementById("staff-email").value = "";
        document.getElementById("staff-password").value = "";
        document.getElementById("staff-hospital").value = "";
      }

      function loginStaff() {
        const email = document.getElementById("login-email").value;
        const password = document.getElementById("login-password").value;

        if (!email || !password) {
          showResult("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô", false);
          return;
        }

        const user = staff.find(
          (s) => s.email === email && s.password === password
        );
        if (user) {
          currentUser = user;
          showResult(
            `‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${user.name} ‡∏à‡∏≤‡∏Å${user.hospital_name}`,
            true
          );
        } else {
          showResult("‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", false);
        }
      }

      function searchPatient() {
        if (!currentUser) {
          showResult("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", false);
          return;
        }

        const nationalId = document.getElementById("search-national-id").value;
        const passport = document.getElementById("search-passport").value;
        const name = document.getElementById("search-name").value;

        if (!nationalId && !passport && !name) {
          showResult("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤", false);
          return;
        }

        // Filter patients by hospital and search criteria
        const results = patients.filter((patient) => {
          if (patient.hospital_id !== currentUser.hospital_id) return false;

          if (nationalId && patient.national_id === nationalId) return true;
          if (passport && patient.passport_id === passport) return true;
          if (
            name &&
            (patient.first_name.includes(name) ||
              patient.last_name.includes(name))
          )
            return true;

          return false;
        });

        if (results.length > 0) {
          showResult(
            `‡∏û‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ${results.length} ‡∏Ñ‡∏ô:\n${JSON.stringify(
              results,
              null,
              2
            )}`,
            true
          );
        } else {
          showResult("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤", false);
        }
      }

      function showResult(message, success) {
        const resultDiv = document.getElementById("api-results");
        const pre = resultDiv.querySelector("pre");

        resultDiv.classList.remove("hidden");
        pre.textContent = message;

        if (success) {
          resultDiv.className =
            "mt-6 p-4 bg-green-50 border border-green-200 rounded-lg";
        } else {
          resultDiv.className =
            "mt-6 p-4 bg-red-50 border border-red-200 rounded-lg";
        }
      }

      // Unit Tests
      function runAllTests() {
        const tests = [
          "test-staff-create-success",
          "test-staff-create-duplicate",
          "test-staff-create-invalid",
          "test-login-success",
          "test-login-invalid",
          "test-login-inactive",
          "test-search-authorized",
          "test-search-unauthorized",
          "test-search-cross-hospital",
        ];

        let passed = 0;
        let failed = 0;

        tests.forEach((testId, index) => {
          setTimeout(() => {
            const testElement = document.getElementById(testId);
            const isPass = Math.random() > 0.2; // 80% pass rate for demo

            if (isPass) {
              testElement.classList.add("test-pass");
              testElement.classList.remove("bg-gray-100");
              passed++;
            } else {
              testElement.classList.add("test-fail");
              testElement.classList.remove("bg-gray-100");
              failed++;
            }

            // Update summary after all tests
            if (index === tests.length - 1) {
              setTimeout(() => {
                document
                  .getElementById("test-summary")
                  .classList.remove("hidden");
                document.getElementById("test-passed").textContent = passed;
                document.getElementById("test-failed").textContent = failed;
              }, 500);
            }
          }, index * 200);
        });
      }

      // Initialize with some demo data
      staff.push({
        id: "staff-demo",
        name: "‡∏´‡∏°‡∏≠‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
        email: "doctor@hospital-a.com",
        password: "password123",
        hospital_id: "hosp-1",
        hospital_name: "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• A",
      });
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'96d7836d439f7335',t:'MTc1NDkxMzAwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
